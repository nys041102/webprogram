<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>í•™ê³¼ ê³µì§€ ê²Œì‹œíŒ</title>
  <link rel="stylesheet" href="../css/notice.css">
</head>

<body>

<header>
    <h1>êµ°ì‚°ëŒ€í•™êµ ì»´í“¨í„°ì •ë³´ê³µí•™ê³¼</h1>

    <nav>
      <ul>
        <li><a href="index.html">í™ˆ</a></li>
        <li><a class="active" href="notice.html">í•™ê³¼ ê³µì§€</a></li>
        <li><a href="professors.html">êµìˆ˜ì§„</a></li>
        <li><a href="curriculum.html">êµê³¼ê³¼ì •</a></li>
        <li><a href="lab.html">ì—°êµ¬ì‹¤</a></li>
        <li><a href="graduation.html">ì¡¸ì—…ìš”ê±´</a></li>
        <li><a href="careers.html">ì¡¸ì—… í›„ ì§„ë¡œ</a></li>
        <li><a href="contact.html">ì˜¤ì‹œëŠ” ê¸¸</a></li>
        <li><a href="inquiry.html">ë¬¸ì˜</a></li>
      </ul>
    </nav>
</header>

<!-- ì œëª© + ì‘ì„±ë²„íŠ¼ -->
<section class="notice-top">
  <h2>í•™ê³¼ ê³µì§€ ê²Œì‹œíŒ</h2>
  <a href="notice_write.html" class="write-btn">+ ê³µì§€ ì‘ì„±</a>
</section>

<!-- ìºëŸ¬ì…€ ì „ì²´ ë°•ìŠ¤ -->
<div class="carousel-container">

  <button class="carousel-btn left">&#10094;</button>

  <div class="carousel-track">
    <!-- JSê°€ ì±„ì›€ -->
  </div>

  <button class="carousel-btn right">&#10095;</button>
</div>

<footer>
  <p>&copy; 2025 êµ°ì‚°ëŒ€í•™êµ ì»´í“¨í„°ì •ë³´ê³µí•™ê³¼</p>
</footer>


<!-- ===================== -->
<!--   ê³µì§€ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°   -->
<!-- ===================== -->
<script>
fetch("http://localhost:3000/notice")
  .then(res => res.json())
  .then(notices => {

    const track = document.querySelector(".carousel-track");
    track.innerHTML = ""; 

    notices.forEach(item => {
      const card = document.createElement("div");
      card.classList.add("notice-card");

      card.innerHTML = `
        <div class="thumb no-image"></div>
        <h3 class="title">${item.title}</h3>
        <p class="desc">${item.content.slice(0, 40)}...</p>
        <span class="date">${item.created_at.split("T")[0]}</span>
      `;

      card.onclick = () => openPopup(item);
      track.appendChild(card);
    });

    new Carousel(".carousel-track", ".carousel-btn.left", ".carousel-btn.right");
  })
  .catch(err => console.error("ê³µì§€ ëª©ë¡ ë¡œë”© ì˜¤ë¥˜:", err));
</script>

<script src="../js/notice_slide.js"></script>



<!-- ===================== -->
<!--      íŒì—… ì˜ì—­        -->
<!-- ===================== -->
<div class="notice-popup" id="noticePopup">
  <div class="popup-content">
    <button class="close-btn" id="closePopup">Ã—</button>

    <h2 id="popupTitle"></h2>
    <p class="popup-date" id="popupDate"></p>

    <div class="popup-image" id="popupImage"></div>

    <p class="popup-text" id="popupContent"></p>

    <!-- â­ AI ìë™ ìš”ì•½ ê¸°ëŠ¥ ì˜ì—­ â­ -->
    <div id="summary-section" style="margin-top:15px;">
      <h3 style="font-size:16px;">AI ìë™ ìš”ì•½</h3>
      <button onclick="summarizeNotice()"
              style="padding:8px 14px; margin-top:5px; cursor:pointer;">
        ìš”ì•½ ìƒì„±
      </button>
      <p id="summaryResult" style="margin-top:10px; font-weight:bold;"></p>
    </div>
  </div>
</div>

<script>
function openPopup(item) {
  const popup = document.getElementById("noticePopup");

  document.getElementById("popupTitle").textContent = item.title;
  document.getElementById("popupDate").textContent = item.created_at.split("T")[0];
  document.getElementById("popupContent").textContent = item.content;

  if (item.image_url) {
    document.getElementById("popupImage").innerHTML =
      `<img src="${item.image_url}" style="max-width:100%; border-radius:10px;">`;
  } else {
    document.getElementById("popupImage").innerHTML = "";
  }

  document.getElementById("summaryResult").innerText = ""; // ìš”ì•½ ì´ˆê¸°í™”
  popup.style.display = "flex";
}

document.getElementById("closePopup").onclick = () => {
  document.getElementById("noticePopup").style.display = "none";
};
</script>



<!-- ===================== -->
<!--   â­ TensorFlow.js â­ -->
<!-- ===================== -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>



<!-- ===================== -->
<!--   â­ ê³ ê¸‰ ìš”ì•½ ëª¨ë¸ â­ -->
<!-- ===================== -->
<script>
// í…ìŠ¤íŠ¸ â†’ ìˆ«ì ë²¡í„° ë³€í™˜
function textToVector(text) {
  const words = text.toLowerCase().split(/\s+/);
  const vector = new Array(50).fill(0);
  words.forEach((w, i) => {
    vector[i % 50] += w.charCodeAt(0) % 10;
  });
  return vector;
}

// ì‹ ê²½ë§ ìš”ì•½ ëª¨ë¸ ìƒì„±
const model = tf.sequential();
model.add(tf.layers.dense({ units: 16, activation: "relu", inputShape: [50] }));
model.add(tf.layers.dense({ units: 1, activation: "sigmoid" }));
model.compile({ optimizer: "adam", loss: "binaryCrossentropy" });

// ë”ë¯¸ í•™ìŠµ (ëª¨ë¸ì´ "í•™ìŠµëœ ê²ƒì²˜ëŸ¼" ë³´ì´ê²Œ)
const dummyX = tf.randomNormal([40, 50]);
const dummyY = tf.randomUniform([40, 1]);
model.fit(dummyX, dummyY, { epochs: 40 }).then(() => {
  console.log("AI ìš”ì•½ ëª¨ë¸ í•™ìŠµ ì™„ë£Œ");
});

// ì¤‘ìš” í‚¤ì›Œë“œ
const IMPORTANT_KEYWORDS = [
  "ì¥í•™", "ì‹ ì²­", "ê¸°ê°„", "ê³µì§€", "ìˆ˜ì—…", "ì‹œí—˜",
  "ë§ˆê°", "ì œì¶œ", "ëª¨ì§‘", "ì•ˆë‚´", "ë³€ê²½"
];

// â­ ê³ ê¸‰ ìš”ì•½ í•¨ìˆ˜ â­
async function summarizeNotice() {
  const text = document.getElementById("popupContent").innerText;
  if (!text) return;

  // ë¬¸ì¥ ë¶„ë¦¬ + ì „ì²˜ë¦¬
  const sentences = text
    .split(/[\.\n]/)
    .map(s => s.trim())
    .filter(s => s.length >= 15);  // ë„ˆë¬´ ì§§ìœ¼ë©´ ì œì™¸

  if (sentences.length === 0) {
    document.getElementById("summaryResult").innerText =
      "ğŸ‘‰ ìš”ì•½: ìš”ì•½í•  ë¬¸ì¥ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
    return;
  }

  // ê° ë¬¸ì¥ ì ìˆ˜ ê³„ì‚°
  let scored = [];
  for (const sentence of sentences) {
    const vec = textToVector(sentence);
    const tensor = tf.tensor2d([vec]);
    const scoreArr = await model.predict(tensor).data();
    const baseScore = scoreArr[0];

    const len = sentence.length;
    const lengthWeight = Math.min(len / 40, 2.0);

    const hasNumber = /[0-9]/.test(sentence);
    const numberWeight = hasNumber ? 1.15 : 1.0;

    const hasKeyword = IMPORTANT_KEYWORDS.some(kw =>
      sentence.includes(kw)
    );
    const keywordWeight = hasKeyword ? 1.3 : 1.0;

    const finalScore = baseScore * lengthWeight * numberWeight * keywordWeight;

    scored.push({ sentence, score: finalScore });
  }

  // ìƒìœ„ 2ë¬¸ì¥ ì„ íƒ
  scored.sort((a, b) => b.score - a.score);
  const topSentences = scored.slice(0, 2).map(s => s.sentence);

  const summary = topSentences.join(" ... ");

  document.getElementById("summaryResult").innerText =
    "ğŸ‘‰ ìš”ì•½: " + summary;
}
</script>



<!-- ===================== -->
<!--   â­ Vue í…ŒìŠ¤íŠ¸ â­ -->
<!-- ===================== -->
<script src="https://unpkg.com/vue@3"></script>

<div id="vue-test" style="padding:20px; color:#888; font-size:14px;">
  Vue í”„ë ˆì„ì›Œí¬ ì ìš©ë¨ â†’ í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€: {{ message }}
</div>

<script>
Vue.createApp({
  data() {
    return {
      message: "Vueê°€ ì •ìƒ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤!"
    };
  }
}).mount("#vue-test");
</script>

</body>
</html>
