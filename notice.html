<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>í•™ê³¼ ê³µì§€ ê²Œì‹œíŒ</title>
  <link rel="stylesheet" href="../css/notice.css">
</head>

<body>

<header>
    <h1>êµ°ì‚°ëŒ€í•™êµ ì»´í“¨í„°ì •ë³´ê³µí•™ê³¼</h1>

    <nav>
      <ul>
        <li><a href="index.html">í™ˆ</a></li>
        <li><a class="active" href="notice.html">í•™ê³¼ ê³µì§€</a></li>
        <li><a href="professors.html">êµìˆ˜ì§„</a></li>
        <li><a href="curriculum.html">êµê³¼ê³¼ì •</a></li>
        <li><a href="lab.html">ì—°êµ¬ì‹¤</a></li>
        <li><a href="graduation.html">ì¡¸ì—…ìš”ê±´</a></li>
        <li><a href="careers.html">ì¡¸ì—… í›„ ì§„ë¡œ</a></li>
        <li><a href="contact.html">ì˜¤ì‹œëŠ” ê¸¸</a></li>
        <li><a href="inquiry.html">ë¬¸ì˜</a></li>
      </ul>
    </nav>
</header>

<!-- ì œëª© + ì‘ì„±ë²„íŠ¼ -->
<section class="notice-top">
  <h2>í•™ê³¼ ê³µì§€ ê²Œì‹œíŒ</h2>
  <a href="notice_write.html" class="write-btn">+ ê³µì§€ ì‘ì„±</a>
</section>

<!-- ìºëŸ¬ì…€ -->
<div class="carousel-container">
  <button class="carousel-btn left">&#10094;</button>

  <div class="carousel-track">
    <!-- JSì—ì„œ ì±„ì›€ -->
  </div>

  <button class="carousel-btn right">&#10095;</button>
</div>

<footer>
  <p>&copy; 2025 êµ°ì‚°ëŒ€í•™êµ ì»´í“¨í„°ì •ë³´ê³µí•™ê³¼</p>
</footer>


<!-- ======================= -->
<!--   ê³µì§€ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°     -->
<!-- ======================= -->
<script>
fetch("http://localhost:3000/notice")
  .then(res => res.json())
  .then(notices => {
    const track = document.querySelector(".carousel-track");
    track.innerHTML = "";

    notices.forEach(item => {
      const card = document.createElement("div");
      card.classList.add("notice-card");

      card.innerHTML = `
        <div class="thumb no-image"></div>
        <h3 class="title">${item.title}</h3>
        <p class="desc">${item.content.slice(0, 40)}...</p>
        <span class="date">${item.created_at.split("T")[0]}</span>
      `;

      card.onclick = () => openPopup(item);
      track.appendChild(card);
    });

    new Carousel(".carousel-track", ".carousel-btn.left", ".carousel-btn.right");
  })
  .catch(err => console.error("ê³µì§€ ëª©ë¡ ë¡œë”© ì˜¤ë¥˜:", err));
</script>

<script src="../js/notice_slide.js"></script>


<!-- ======================= -->
<!--         íŒì—…            -->
<!-- ======================= -->
<div class="notice-popup" id="noticePopup">
  <div class="popup-content">
    <button class="close-btn" id="closePopup">Ã—</button>

    <h2 id="popupTitle"></h2>
    <p class="popup-date" id="popupDate"></p>

    <div class="popup-image" id="popupImage"></div>

    <p class="popup-text" id="popupContent"></p>

    <!-- â­ AI ìš”ì•½ ê¸°ëŠ¥ â­ -->
    <div id="summary-section" style="margin-top:15px;">
      <h3 style="font-size:16px;">AI ìë™ ìš”ì•½</h3>
      <button onclick="summarizeNotice()" 
              style="padding:8px 14px; margin-top:5px; cursor:pointer;">
        ìš”ì•½ ìƒì„±
      </button>
      <p id="summaryResult" style="margin-top:10px; font-weight:bold;"></p>
    </div>
  </div>
</div>

<script>
function openPopup(item) {
  const popup = document.getElementById("noticePopup");

  document.getElementById("popupTitle").textContent = item.title;
  document.getElementById("popupDate").textContent = item.created_at.split("T")[0];
  document.getElementById("popupContent").textContent = item.content;

  if (item.image_url) {
    document.getElementById("popupImage").innerHTML =
      `<img src="${item.image_url}" style="max-width:100%; border-radius:10px;">`;
  } else {
    document.getElementById("popupImage").innerHTML = "";
  }

  document.getElementById("summaryResult").innerText = "";
  popup.style.display = "flex";
}

document.getElementById("closePopup").onclick = () => {
  document.getElementById("noticePopup").style.display = "none";
};
</script>


<!-- ======================= -->
<!--    TensorFlow.js        -->
<!-- ======================= -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>

<script>
// í…ìŠ¤íŠ¸ ë²¡í„° ë³€í™˜
function textToVector(text) {
  const words = text.toLowerCase().split(/\s+/);
  const vector = new Array(50).fill(0);
  words.forEach((w, i) => {
    vector[i % 50] += w.charCodeAt(0) % 10;
  });
  return vector;
}

const IMPORTANT_KEYWORDS = [
  "ì¥í•™", "ì‹ ì²­", "ê¸°ê°„", "ê³µì§€", "ìˆ˜ì—…", "ì‹œí—˜",
  "ë§ˆê°", "ì œì¶œ", "ëª¨ì§‘", "ì•ˆë‚´", "ë³€ê²½"
];

// ìš”ì•½ ëª¨ë¸ ìƒì„±
const model = tf.sequential();
model.add(tf.layers.dense({ units: 16, activation: "relu", inputShape: [50] }));
model.add(tf.layers.dense({ units: 1, activation: "sigmoid" }));
model.compile({ optimizer: "adam", loss: "binaryCrossentropy" });

// ë”ë¯¸ í•™ìŠµ
const dummyX = tf.randomNormal([40, 50]);
const dummyY = tf.randomUniform([40, 1]);
model.fit(dummyX, dummyY, { epochs: 40 }).then(() => {
  console.log("AI ìš”ì•½ ëª¨ë¸ í•™ìŠµ ì™„ë£Œ");
});

// ìš”ì•½ í•¨ìˆ˜
async function summarizeNotice() {
  const text = document.getElementById("popupContent").innerText;

  const sentences = text
    .split(/[\.\n]/)
    .map(s => s.trim())
    .filter(s => s.length >= 15);

  let scored = [];

  for (const sentence of sentences) {
    const vec = textToVector(sentence);
    const tensor = tf.tensor2d([vec]);
    const baseScore = (await model.predict(tensor).data())[0];

    const lengthWeight = Math.min(sentence.length / 40, 2.0);
    const numberWeight = /[0-9]/.test(sentence) ? 1.15 : 1.0;
    const keywordWeight = IMPORTANT_KEYWORDS.some(kw => sentence.includes(kw)) ? 1.3 : 1.0;

    const finalScore = baseScore * lengthWeight * numberWeight * keywordWeight;

    scored.push({ sentence, score: finalScore });
  }

  scored.sort((a, b) => b.score - a.score);
  const summary = scored.slice(0, 2).map(s => s.sentence).join(" ... ");

  document.getElementById("summaryResult").innerText = "ğŸ‘‰ ìš”ì•½: " + summary;
}
</script>



<!-- ======================= -->
<!--        Vue ì˜ì—­          -->
<!-- ======================= -->
<script src="https://unpkg.com/vue@3"></script>

<div id="vue-test" style="padding:20px; color:#888; font-size:14px;">
  Vue í”„ë ˆì„ì›Œí¬ ì ìš©ë¨ â†’ í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€: {{ message }}
</div>

<script>
Vue.createApp({
  data() {
    return { message: "Vueê°€ ì •ìƒ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤!" };
  }
}).mount("#vue-test");
</script>



<!-- ======================= -->
<!--      React ê²€ìƒ‰ ì˜ì—­     -->
<!-- ======================= -->

<!-- React CDN -->
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

<!-- ê²€ìƒ‰ UIê°€ ë Œë”ë§ë  ìë¦¬ -->
<div id="react-search" style="padding:20px; margin-top:30px;"></div>

<script>
function NoticeSearch() {
  const [query, setQuery] = React.useState("");
  const [results, setResults] = React.useState([]);

  const handleSearch = async (e) => {
    const value = e.target.value;
    setQuery(value);

    const res = await fetch("http://localhost:3000/notice");
    const notices = await res.json();

    const filtered = notices.filter(n =>
      n.title.includes(value) || n.content.includes(value)
    );

    setResults(filtered);
  };

  return React.createElement(
    "div",
    { style: {
        background: "#fff",
        padding: "20px",
        borderRadius: "12px",
        boxShadow: "0 5px 15px rgba(0,0,0,0.1)"
      }},

    React.createElement("input", {
      type: "text",
      placeholder: "ê³µì§€ ê²€ìƒ‰ (ì œëª©/ë‚´ìš©)",
      value: query,
      onChange: handleSearch,
      style: {
        padding: "12px 15px",
        width: "100%",
        borderRadius: "10px",
        border: "1px solid #ccc",
        marginBottom: "20px",
        fontSize: "16px"
      }
    }),

    React.createElement(
      "div",
      null,
      results.length === 0 && query !== ""
        ? React.createElement("p", { style: { color: "#888" }}, "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.")
        : results.map(n =>
            React.createElement(
              "div",
              {
                key: n.id,
                onClick: () => openPopup(n),
                style: {
                  padding: "12px 15px",
                  background: "#f8f8f8",
                  borderRadius: "8px",
                  marginBottom: "12px",
                  cursor: "pointer",
                  transition: "0.2s"
                }
              },
              React.createElement("strong", null, n.title),
              React.createElement("p", null, n.content.slice(0, 40) + "...")
            )
          )
    )
  );
}

const searchRoot = ReactDOM.createRoot(document.getElementById("react-search"));
searchRoot.render(React.createElement(NoticeSearch));
</script>

</body>
</html>
