<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>문의하기 - 군산대학교 컴퓨터정보공학과</title>
  <link rel="stylesheet" href="../css/inquiry.css" />
</head>
<body>

  <header>
    <h1>군산대학교 컴퓨터정보공학과</h1>
    <nav>
      <ul>
        <li><a href="index.html">홈</a></li>
        <li><a href="notice.html">학과 공지</a></li>
        <li><a href="professors.html">교수진</a></li>
        <li><a href="curriculum.html">교과과정</a></li>
        <li><a href="lab.html">연구실</a></li>
        <li><a href="graduation.html">졸업요건</a></li>
        <li><a href="careers.html">졸업 후 진로</a></li>
        <li><a href="contact.html">오시는 길</a></li>
        <li><a class="active" href="inquiry.html">문의</a></li>
      </ul>
    </nav>
  </header>

  <main class="inquiry-container">
    <h2>문의하기</h2>
    <p>궁금한 점이나 건의 사항을 아래 댓글로 남겨주세요.</p>

    <!-- ⭐ 댓글 작성 폼 -->
    <div class="comment-form">
      <input type="text" id="inqName" placeholder="이름을 입력하세요" required>
      <textarea id="inqMessage" placeholder="댓글을 입력하세요..." required></textarea>
      <button id="inqSend" type="button">댓글 등록</button>
    </div>

    <!-- ⭐ 댓글 목록 -->
    <div class="comment-list" id="inqList"></div>

  </main>

  <footer>
    <p>&copy; 2025 군산대학교 컴퓨터정보공학과</p>
  </footer>

  <script>
    const sendBtn = document.getElementById("inqSend");
    const listBox = document.getElementById("inqList");

    // ⭐ 문의 등록 (POST)
    sendBtn.onclick = () => {
      const name = document.getElementById("inqName").value;
      const message = document.getElementById("inqMessage").value;

      if (!name || !message) {
        alert("이름과 내용을 입력해주세요.");
        return;
      }

      fetch("http://localhost:3000/inquiry", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, message })
      })
      .then(res => res.json())
      .then(result => {
        if (result.success) {
          loadInquiry(); // 저장 후 목록 자동 업데이트
          document.getElementById("inqMessage").value = "";
        } else {
          alert("저장 실패: " + result.error);
        }
      })
      .catch(err => console.error("문의 저장 오류:", err));
    };

    // ⭐ 문의 목록 불러오기 (GET)
    function loadInquiry() {
      fetch("http://localhost:3000/inquiry")
        .then(res => res.json())
        .then(list => {
          listBox.innerHTML = "";

          list.forEach(item => {
            listBox.innerHTML += `
              <div class="comment-item">
                <p class="comment-text">${item.message}</p>
                <span class="comment-date">${item.created_at.slice(0, 10)} / ${item.name}</span>
              </div>
            `;
          });
        })
        .catch(err => console.error("문의 불러오기 오류:", err));
    }

    // 페이지 열릴 때 자동 실행
    loadInquiry();
  </script>

</body>
</html>
