<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>공지 작성</title>
  <link rel="stylesheet" href="../css/notice_write.css">
</head>
<body>

<header>
  <div class="header-inner">
    <h1>공지 작성</h1>
  </div>
</header>

<div class="write-header">
  <a href="notice.html" class="back-btn">← 공지 목록으로</a>
</div>

<div class="write-container">

  <label>공지 제목</label>
  <input type="text" id="title">

  <label>공지 내용</label>
  <textarea id="content" rows="6"></textarea>

  <label>이미지 업로드</label>
  <input type="file" id="imageInput" accept="image/*">

  <button id="saveBtn">저장하기</button>
</div>

<script>
document.getElementById("saveBtn").onclick = async () => {
  const title = document.getElementById("title").value;
  const content = document.getElementById("content").value;
  const imageInput = document.getElementById("imageInput").files[0];

  if (!title || !content) {
    alert("제목과 내용을 입력하세요.");
    return;
  }

  // 1) 이미지 → base64 변환
  const convertImage = () =>
    new Promise((resolve) => {
      if (!imageInput) return resolve(null);

      const reader = new FileReader();
      reader.onload = () => resolve(reader.result);
      reader.readAsDataURL(imageInput);
    });

  const image = await convertImage();

  // 2) 서버로 전송
  const response = await fetch("/notice", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({ title, content, image })
  });

  const result = await response.json();

  if (result.success) {
    alert("공지 저장 완료!");
    location.href = "notice.html";
  } else {
    alert("저장 실패: " + result.error);
  }
};
</script>





</body>
</html>
